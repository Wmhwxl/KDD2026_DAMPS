02 Oct 12:42    INFO ██Server: 	server28
02 Oct 12:42    INFO ██Dir: 	/home/wangminghui/workspace/KDD_C1_DAMPS_released_code/src

02 Oct 12:42    INFO 
gpu_id=0
use_gpu=True
seed=[999]
data_path=../data/
inter_splitting_label=x_label
filter_out_cod_start_users=True
is_multimodal_model=True
checkpoint_dir=saved
save_recommended_topk=True
recommend_topk=recommend_topk/
embedding_size=256
weight_decay=0.0
req_training=True
epochs=1000
stopping_step=20
train_batch_size=2048
learner=adam
learning_rate=0.001
learning_rate_scheduler=[0.96, 50]
eval_step=1
training_neg_sample_num=1
use_neg_sampling=True
use_full_sampling=False
NEG_PREFIX=neg__
USER_ID_FIELD=userID
ITEM_ID_FIELD=itemID
TIME_FIELD=timestamp
field_separator=	
metrics=['Recall', 'NDCG']
topk=[10, 20]
valid_metric=Recall@20
eval_batch_size=4096
use_raw_features=False
max_txt_len=32
max_img_size=256
vocab_size=30522
type_vocab_size=2
hidden_size=4
pad_token_id=0
max_position_embeddings=512
layer_norm_eps=1e-12
hidden_dropout_prob=0.1
end2end=False
hyper_parameters=['seed', 'cl_loss']
inter_file_name=clothing.inter
vision_feature_file=image_feat.npy
text_feature_file=text_feat.npy
user_graph_dict_file=user_graph_dict.npy
n_ui_layers=2
n_layers=1
lambda_coeff=0.9
reg_weight=0.0001
knn_k=10
cl_loss=[0.01]
save_dir=./saved_models
model=MGCN
dataset=clothing
valid_metric_bigger=True
device=cuda


02 Aug 12:42    INFO clothing
The number of users: 39387
Average actions of users: 7.075354812501587
The number of items: 23033
Average actions of items: 12.099031823904832
The number of inters: 278677
The sparsity of the dataset: 99.969281661909%
02 Aug 12:42    INFO 
====Training====
clothing
The number of users: 39387
Average actions of users: 5.010231802371341
The number of items: 23020
Average actions of items: 8.572458731537793
The number of inters: 197338
The sparsity of the dataset: 99.97823530928596%
02 Aug 12:42    INFO 
====Validation====
clothing
The number of users: 39387
Average actions of users: 1.0193718739685682
The number of items: 16702
Average actions of items: 2.4039037241048975
The number of inters: 40150
The sparsity of the dataset: 99.99389670773579%
02 Aug 12:42    INFO 
====Testing====
clothing
The number of users: 39387
Average actions of users: 1.0457511361616778
The number of items: 16803
Average actions of items: 2.451288460393977
The number of inters: 41189
The sparsity of the dataset: 99.99377640221293%
02 Aug 12:42    INFO 

=================================


02 Aug 12:42    INFO =========1/1: Parameters:['seed', 'cl_loss']=(999, 0.01)=======
/home/wangminghui/workspace/KDD_C1_DAMPS_released_code/src/models/mgcn.py:122: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(rowsum, -0.5).flatten()
/home/wangminghui/workspace/KDD_C1_DAMPS_released_code/src/models/mgcn.py:145: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:641.)
  return torch.sparse.FloatTensor(indices, values, shape)
/home/wangminghui/workspace/KDD_C1_DAMPS_released_code/src/models/mgcn.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  image_adj = torch.load(image_adj_file)
/home/wangminghui/workspace/KDD_C1_DAMPS_released_code/src/models/mgcn.py:64: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  text_adj = torch.load(text_adj_file)
02 Aug 12:42    INFO MGCN(
  (user_embedding): Embedding(39387, 256)
  (item_id_embedding): Embedding(23033, 256)
  (image_embedding): Embedding(23033, 4096)
  (text_embedding): Embedding(23033, 384)
  (image_trs): Linear(in_features=4096, out_features=256, bias=True)
  (text_trs): Linear(in_features=384, out_features=256, bias=True)
  (softmax): Softmax(dim=-1)
  (query_common): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Tanh()
    (2): Linear(in_features=256, out_features=1, bias=False)
  )
  (gate_v): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Sigmoid()
  )
  (gate_t): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Sigmoid()
  )
  (gate_image_prefer): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Sigmoid()
  )
  (gate_text_prefer): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): Sigmoid()
  )
  (feature_filter): DAMPS(
    (image_embedding): Embedding(23033, 4096)
    (text_embedding): Embedding(23033, 384)
    (image_trs): Linear(in_features=4096, out_features=256, bias=True)
    (text_trs): Linear(in_features=384, out_features=256, bias=True)
  )
)
Trainable parameters: 224979589
02 Aug 12:42    INFO epoch 0 training [time: 5.49s, train loss: 73.5627]
02 Aug 12:42    INFO epoch 0 evaluating [time: 2.34s, valid_score: 0.089200]
02 Aug 12:42    INFO valid result: 
recall@10: 0.0618    recall@20: 0.0892    ndcg@10: 0.0332    ndcg@20: 0.0401    
02 Aug 12:42    INFO test result: 
recall@10: 0.0621    recall@20: 0.0885    ndcg@10: 0.0335    ndcg@20: 0.0402    
02 Aug 12:42    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:43    INFO epoch 1 training [time: 5.22s, train loss: 71.7484]
02 Aug 12:43    INFO epoch 1 evaluating [time: 2.33s, valid_score: 0.085700]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0579    recall@20: 0.0857    ndcg@10: 0.0313    ndcg@20: 0.0383    
02 Aug 12:43    INFO test result: 
recall@10: 0.0587    recall@20: 0.0845    ndcg@10: 0.0321    ndcg@20: 0.0386    
02 Aug 12:43    INFO epoch 2 training [time: 5.19s, train loss: 68.6832]
02 Aug 12:43    INFO epoch 2 evaluating [time: 2.17s, valid_score: 0.079400]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0543    recall@20: 0.0794    ndcg@10: 0.0293    ndcg@20: 0.0356    
02 Aug 12:43    INFO test result: 
recall@10: 0.0543    recall@20: 0.0793    ndcg@10: 0.0301    ndcg@20: 0.0364    
02 Aug 12:43    INFO epoch 3 training [time: 5.20s, train loss: 59.7514]
02 Aug 12:43    INFO epoch 3 evaluating [time: 2.17s, valid_score: 0.074600]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0518    recall@20: 0.0746    ndcg@10: 0.0280    ndcg@20: 0.0338    
02 Aug 12:43    INFO test result: 
recall@10: 0.0522    recall@20: 0.0751    ndcg@10: 0.0290    ndcg@20: 0.0348    
02 Aug 12:43    INFO epoch 4 training [time: 5.17s, train loss: 45.1877]
02 Aug 12:43    INFO epoch 4 evaluating [time: 2.32s, valid_score: 0.076000]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0522    recall@20: 0.0760    ndcg@10: 0.0286    ndcg@20: 0.0345    
02 Aug 12:43    INFO test result: 
recall@10: 0.0530    recall@20: 0.0768    ndcg@10: 0.0295    ndcg@20: 0.0356    
02 Aug 12:43    INFO epoch 5 training [time: 5.16s, train loss: 32.6184]
02 Aug 12:43    INFO epoch 5 evaluating [time: 2.30s, valid_score: 0.079800]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0545    recall@20: 0.0798    ndcg@10: 0.0298    ndcg@20: 0.0362    
02 Aug 12:43    INFO test result: 
recall@10: 0.0550    recall@20: 0.0809    ndcg@10: 0.0306    ndcg@20: 0.0371    
02 Aug 12:43    INFO epoch 6 training [time: 5.18s, train loss: 24.6558]
02 Aug 12:43    INFO epoch 6 evaluating [time: 2.19s, valid_score: 0.083700]
02 Aug 12:43    INFO valid result: 
recall@10: 0.0573    recall@20: 0.0837    ndcg@10: 0.0312    ndcg@20: 0.0378    
02 Aug 12:43    INFO test result: 
recall@10: 0.0570    recall@20: 0.0841    ndcg@10: 0.0317    ndcg@20: 0.0386    
02 Aug 12:44    INFO epoch 7 training [time: 5.17s, train loss: 19.7272]
02 Aug 12:44    INFO epoch 7 evaluating [time: 2.17s, valid_score: 0.086700]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0594    recall@20: 0.0867    ndcg@10: 0.0323    ndcg@20: 0.0392    
02 Aug 12:44    INFO test result: 
recall@10: 0.0595    recall@20: 0.0878    ndcg@10: 0.0329    ndcg@20: 0.0401    
02 Aug 12:44    INFO epoch 8 training [time: 5.19s, train loss: 16.5113]
02 Aug 12:44    INFO epoch 8 evaluating [time: 2.19s, valid_score: 0.089900]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0612    recall@20: 0.0899    ndcg@10: 0.0332    ndcg@20: 0.0405    
02 Aug 12:44    INFO test result: 
recall@10: 0.0618    recall@20: 0.0908    ndcg@10: 0.0339    ndcg@20: 0.0413    
02 Aug 12:44    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:44    INFO epoch 9 training [time: 5.18s, train loss: 14.3738]
02 Aug 12:44    INFO epoch 9 evaluating [time: 2.28s, valid_score: 0.093400]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0626    recall@20: 0.0934    ndcg@10: 0.0342    ndcg@20: 0.0419    
02 Aug 12:44    INFO test result: 
recall@10: 0.0635    recall@20: 0.0931    ndcg@10: 0.0348    ndcg@20: 0.0423    
02 Aug 12:44    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:44    INFO epoch 10 training [time: 5.15s, train loss: 12.7843]
02 Aug 12:44    INFO epoch 10 evaluating [time: 2.29s, valid_score: 0.094900]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0644    recall@20: 0.0949    ndcg@10: 0.0350    ndcg@20: 0.0427    
02 Aug 12:44    INFO test result: 
recall@10: 0.0643    recall@20: 0.0948    ndcg@10: 0.0354    ndcg@20: 0.0431    
02 Aug 12:44    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:44    INFO epoch 11 training [time: 5.16s, train loss: 11.6994]
02 Aug 12:44    INFO epoch 11 evaluating [time: 2.17s, valid_score: 0.096700]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0660    recall@20: 0.0967    ndcg@10: 0.0358    ndcg@20: 0.0435    
02 Aug 12:44    INFO test result: 
recall@10: 0.0660    recall@20: 0.0962    ndcg@10: 0.0360    ndcg@20: 0.0436    
02 Aug 12:44    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:44    INFO epoch 12 training [time: 5.16s, train loss: 10.8611]
02 Aug 12:44    INFO epoch 12 evaluating [time: 2.18s, valid_score: 0.097700]
02 Aug 12:44    INFO valid result: 
recall@10: 0.0670    recall@20: 0.0977    ndcg@10: 0.0363    ndcg@20: 0.0440    
02 Aug 12:44    INFO test result: 
recall@10: 0.0666    recall@20: 0.0977    ndcg@10: 0.0363    ndcg@20: 0.0442    
02 Aug 12:44    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:44    INFO epoch 13 training [time: 5.17s, train loss: 10.2190]
02 Aug 12:45    INFO epoch 13 evaluating [time: 2.16s, valid_score: 0.098600]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0681    recall@20: 0.0986    ndcg@10: 0.0368    ndcg@20: 0.0445    
02 Aug 12:45    INFO test result: 
recall@10: 0.0672    recall@20: 0.0990    ndcg@10: 0.0368    ndcg@20: 0.0449    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 14 training [time: 5.16s, train loss: 9.6919]
02 Aug 12:45    INFO epoch 14 evaluating [time: 2.29s, valid_score: 0.099800]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0690    recall@20: 0.0998    ndcg@10: 0.0373    ndcg@20: 0.0451    
02 Aug 12:45    INFO test result: 
recall@10: 0.0681    recall@20: 0.0999    ndcg@10: 0.0373    ndcg@20: 0.0453    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 15 training [time: 5.19s, train loss: 9.3294]
02 Aug 12:45    INFO epoch 15 evaluating [time: 2.19s, valid_score: 0.100900]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0697    recall@20: 0.1009    ndcg@10: 0.0376    ndcg@20: 0.0455    
02 Aug 12:45    INFO test result: 
recall@10: 0.0691    recall@20: 0.1007    ndcg@10: 0.0378    ndcg@20: 0.0458    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 16 training [time: 5.17s, train loss: 8.9820]
02 Aug 12:45    INFO epoch 16 evaluating [time: 2.18s, valid_score: 0.101900]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0700    recall@20: 0.1019    ndcg@10: 0.0378    ndcg@20: 0.0458    
02 Aug 12:45    INFO test result: 
recall@10: 0.0695    recall@20: 0.1011    ndcg@10: 0.0380    ndcg@20: 0.0461    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 17 training [time: 5.18s, train loss: 8.6934]
02 Aug 12:45    INFO epoch 17 evaluating [time: 2.18s, valid_score: 0.102900]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0711    recall@20: 0.1029    ndcg@10: 0.0383    ndcg@20: 0.0463    
02 Aug 12:45    INFO test result: 
recall@10: 0.0700    recall@20: 0.1024    ndcg@10: 0.0384    ndcg@20: 0.0466    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 18 training [time: 5.16s, train loss: 8.4508]
02 Aug 12:45    INFO epoch 18 evaluating [time: 2.31s, valid_score: 0.103600]
02 Aug 12:45    INFO valid result: 
recall@10: 0.0709    recall@20: 0.1036    ndcg@10: 0.0384    ndcg@20: 0.0466    
02 Aug 12:45    INFO test result: 
recall@10: 0.0705    recall@20: 0.1036    ndcg@10: 0.0387    ndcg@20: 0.0471    
02 Aug 12:45    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:45    INFO epoch 19 training [time: 5.16s, train loss: 8.2497]
02 Aug 12:46    INFO epoch 19 evaluating [time: 2.16s, valid_score: 0.103800]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0715    recall@20: 0.1038    ndcg@10: 0.0387    ndcg@20: 0.0468    
02 Aug 12:46    INFO test result: 
recall@10: 0.0707    recall@20: 0.1038    ndcg@10: 0.0390    ndcg@20: 0.0474    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 20 training [time: 5.16s, train loss: 8.0740]
02 Aug 12:46    INFO epoch 20 evaluating [time: 2.18s, valid_score: 0.104300]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0718    recall@20: 0.1043    ndcg@10: 0.0388    ndcg@20: 0.0470    
02 Aug 12:46    INFO test result: 
recall@10: 0.0711    recall@20: 0.1040    ndcg@10: 0.0390    ndcg@20: 0.0474    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 21 training [time: 5.16s, train loss: 7.9356]
02 Aug 12:46    INFO epoch 21 evaluating [time: 2.15s, valid_score: 0.104600]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0721    recall@20: 0.1046    ndcg@10: 0.0390    ndcg@20: 0.0472    
02 Aug 12:46    INFO test result: 
recall@10: 0.0714    recall@20: 0.1049    ndcg@10: 0.0392    ndcg@20: 0.0478    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 22 training [time: 5.17s, train loss: 7.8110]
02 Aug 12:46    INFO epoch 22 evaluating [time: 2.16s, valid_score: 0.105500]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0724    recall@20: 0.1055    ndcg@10: 0.0392    ndcg@20: 0.0475    
02 Aug 12:46    INFO test result: 
recall@10: 0.0720    recall@20: 0.1055    ndcg@10: 0.0395    ndcg@20: 0.0481    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 23 training [time: 5.16s, train loss: 7.6548]
02 Aug 12:46    INFO epoch 23 evaluating [time: 2.31s, valid_score: 0.106100]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0728    recall@20: 0.1061    ndcg@10: 0.0394    ndcg@20: 0.0478    
02 Aug 12:46    INFO test result: 
recall@10: 0.0719    recall@20: 0.1061    ndcg@10: 0.0395    ndcg@20: 0.0482    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 24 training [time: 5.17s, train loss: 7.5616]
02 Aug 12:46    INFO epoch 24 evaluating [time: 2.17s, valid_score: 0.106900]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0734    recall@20: 0.1069    ndcg@10: 0.0396    ndcg@20: 0.0481    
02 Aug 12:46    INFO test result: 
recall@10: 0.0724    recall@20: 0.1063    ndcg@10: 0.0396    ndcg@20: 0.0482    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:46    INFO epoch 25 training [time: 5.16s, train loss: 7.4713]
02 Aug 12:46    INFO epoch 25 evaluating [time: 2.18s, valid_score: 0.107000]
02 Aug 12:46    INFO valid result: 
recall@10: 0.0736    recall@20: 0.1070    ndcg@10: 0.0397    ndcg@20: 0.0481    
02 Aug 12:46    INFO test result: 
recall@10: 0.0724    recall@20: 0.1065    ndcg@10: 0.0396    ndcg@20: 0.0483    
02 Aug 12:46    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:47    INFO epoch 26 training [time: 5.17s, train loss: 7.3809]
02 Aug 12:47    INFO epoch 26 evaluating [time: 2.18s, valid_score: 0.107200]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0739    recall@20: 0.1072    ndcg@10: 0.0399    ndcg@20: 0.0483    
02 Aug 12:47    INFO test result: 
recall@10: 0.0729    recall@20: 0.1066    ndcg@10: 0.0399    ndcg@20: 0.0484    
02 Aug 12:47    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:47    INFO epoch 27 training [time: 5.16s, train loss: 7.3125]
02 Aug 12:47    INFO epoch 27 evaluating [time: 2.28s, valid_score: 0.107600]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0739    recall@20: 0.1076    ndcg@10: 0.0399    ndcg@20: 0.0484    
02 Aug 12:47    INFO test result: 
recall@10: 0.0728    recall@20: 0.1067    ndcg@10: 0.0400    ndcg@20: 0.0486    
02 Aug 12:47    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:47    INFO epoch 28 training [time: 5.18s, train loss: 7.2339]
02 Aug 12:47    INFO epoch 28 evaluating [time: 2.28s, valid_score: 0.107300]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0736    recall@20: 0.1073    ndcg@10: 0.0399    ndcg@20: 0.0484    
02 Aug 12:47    INFO test result: 
recall@10: 0.0734    recall@20: 0.1071    ndcg@10: 0.0401    ndcg@20: 0.0487    
02 Aug 12:47    INFO epoch 29 training [time: 5.18s, train loss: 7.1890]
02 Aug 12:47    INFO epoch 29 evaluating [time: 2.19s, valid_score: 0.107900]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0742    recall@20: 0.1079    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:47    INFO test result: 
recall@10: 0.0740    recall@20: 0.1070    ndcg@10: 0.0402    ndcg@20: 0.0486    
02 Aug 12:47    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:47    INFO epoch 30 training [time: 5.18s, train loss: 7.0977]
02 Aug 12:47    INFO epoch 30 evaluating [time: 2.17s, valid_score: 0.108100]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0743    recall@20: 0.1081    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:47    INFO test result: 
recall@10: 0.0741    recall@20: 0.1073    ndcg@10: 0.0403    ndcg@20: 0.0488    
02 Aug 12:47    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:47    INFO epoch 31 training [time: 5.17s, train loss: 7.0512]
02 Aug 12:47    INFO epoch 31 evaluating [time: 2.20s, valid_score: 0.108300]
02 Aug 12:47    INFO valid result: 
recall@10: 0.0746    recall@20: 0.1083    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:47    INFO test result: 
recall@10: 0.0741    recall@20: 0.1082    ndcg@10: 0.0404    ndcg@20: 0.0491    
02 Aug 12:47    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:48    INFO epoch 32 training [time: 5.18s, train loss: 7.0098]
02 Aug 12:48    INFO epoch 32 evaluating [time: 2.31s, valid_score: 0.108400]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0747    recall@20: 0.1084    ndcg@10: 0.0402    ndcg@20: 0.0487    
02 Aug 12:48    INFO test result: 
recall@10: 0.0741    recall@20: 0.1084    ndcg@10: 0.0403    ndcg@20: 0.0490    
02 Aug 12:48    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:48    INFO epoch 33 training [time: 5.17s, train loss: 6.9475]
02 Aug 12:48    INFO epoch 33 evaluating [time: 2.31s, valid_score: 0.108300]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0749    recall@20: 0.1083    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:48    INFO test result: 
recall@10: 0.0743    recall@20: 0.1085    ndcg@10: 0.0403    ndcg@20: 0.0490    
02 Aug 12:48    INFO epoch 34 training [time: 5.18s, train loss: 6.9006]
02 Aug 12:48    INFO epoch 34 evaluating [time: 2.19s, valid_score: 0.108600]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0748    recall@20: 0.1086    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:48    INFO test result: 
recall@10: 0.0741    recall@20: 0.1085    ndcg@10: 0.0403    ndcg@20: 0.0491    
02 Aug 12:48    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:48    INFO epoch 35 training [time: 5.16s, train loss: 6.8531]
02 Aug 12:48    INFO epoch 35 evaluating [time: 2.16s, valid_score: 0.108600]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0749    recall@20: 0.1086    ndcg@10: 0.0402    ndcg@20: 0.0487    
02 Aug 12:48    INFO test result: 
recall@10: 0.0745    recall@20: 0.1085    ndcg@10: 0.0405    ndcg@20: 0.0491    
02 Aug 12:48    INFO epoch 36 training [time: 5.18s, train loss: 6.8037]
02 Aug 12:48    INFO epoch 36 evaluating [time: 2.28s, valid_score: 0.108500]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0749    recall@20: 0.1085    ndcg@10: 0.0401    ndcg@20: 0.0486    
02 Aug 12:48    INFO test result: 
recall@10: 0.0744    recall@20: 0.1088    ndcg@10: 0.0404    ndcg@20: 0.0492    
02 Aug 12:48    INFO epoch 37 training [time: 5.20s, train loss: 6.7709]
02 Aug 12:48    INFO epoch 37 evaluating [time: 2.31s, valid_score: 0.108200]
02 Aug 12:48    INFO valid result: 
recall@10: 0.0751    recall@20: 0.1082    ndcg@10: 0.0401    ndcg@20: 0.0485    
02 Aug 12:48    INFO test result: 
recall@10: 0.0743    recall@20: 0.1091    ndcg@10: 0.0405    ndcg@20: 0.0493    
02 Aug 12:48    INFO epoch 38 training [time: 5.23s, train loss: 6.7460]
02 Aug 12:49    INFO epoch 38 evaluating [time: 2.24s, valid_score: 0.108900]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0753    recall@20: 0.1089    ndcg@10: 0.0403    ndcg@20: 0.0487    
02 Aug 12:49    INFO test result: 
recall@10: 0.0745    recall@20: 0.1093    ndcg@10: 0.0405    ndcg@20: 0.0493    
02 Aug 12:49    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:49    INFO epoch 39 training [time: 5.22s, train loss: 6.6985]
02 Aug 12:49    INFO epoch 39 evaluating [time: 2.26s, valid_score: 0.109000]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0750    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0487    
02 Aug 12:49    INFO test result: 
recall@10: 0.0746    recall@20: 0.1093    ndcg@10: 0.0405    ndcg@20: 0.0493    
02 Aug 12:49    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:49    INFO epoch 40 training [time: 5.22s, train loss: 6.6629]
02 Aug 12:49    INFO epoch 40 evaluating [time: 2.34s, valid_score: 0.109000]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0751    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0487    
02 Aug 12:49    INFO test result: 
recall@10: 0.0742    recall@20: 0.1091    ndcg@10: 0.0405    ndcg@20: 0.0493    
02 Aug 12:49    INFO epoch 41 training [time: 5.22s, train loss: 6.6276]
02 Aug 12:49    INFO epoch 41 evaluating [time: 2.37s, valid_score: 0.109200]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0749    recall@20: 0.1092    ndcg@10: 0.0401    ndcg@20: 0.0487    
02 Aug 12:49    INFO test result: 
recall@10: 0.0740    recall@20: 0.1091    ndcg@10: 0.0403    ndcg@20: 0.0492    
02 Aug 12:49    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:49    INFO epoch 42 training [time: 5.24s, train loss: 6.5993]
02 Aug 12:49    INFO epoch 42 evaluating [time: 2.38s, valid_score: 0.109100]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0746    recall@20: 0.1091    ndcg@10: 0.0401    ndcg@20: 0.0488    
02 Aug 12:49    INFO test result: 
recall@10: 0.0736    recall@20: 0.1090    ndcg@10: 0.0401    ndcg@20: 0.0491    
02 Aug 12:49    INFO epoch 43 training [time: 5.22s, train loss: 6.5743]
02 Aug 12:49    INFO epoch 43 evaluating [time: 2.23s, valid_score: 0.109100]
02 Aug 12:49    INFO valid result: 
recall@10: 0.0745    recall@20: 0.1091    ndcg@10: 0.0400    ndcg@20: 0.0487    
02 Aug 12:49    INFO test result: 
recall@10: 0.0733    recall@20: 0.1089    ndcg@10: 0.0400    ndcg@20: 0.0491    
02 Aug 12:49    INFO epoch 44 training [time: 5.22s, train loss: 6.5366]
02 Aug 12:50    INFO epoch 44 evaluating [time: 2.26s, valid_score: 0.109300]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0742    recall@20: 0.1093    ndcg@10: 0.0400    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0732    recall@20: 0.1092    ndcg@10: 0.0399    ndcg@20: 0.0491    
02 Aug 12:50    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:50    INFO epoch 45 training [time: 5.23s, train loss: 6.5235]
02 Aug 12:50    INFO epoch 45 evaluating [time: 2.37s, valid_score: 0.109600]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0743    recall@20: 0.1096    ndcg@10: 0.0399    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0732    recall@20: 0.1095    ndcg@10: 0.0401    ndcg@20: 0.0493    
02 Aug 12:50    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:50    INFO epoch 46 training [time: 5.21s, train loss: 6.4950]
02 Aug 12:50    INFO epoch 46 evaluating [time: 2.35s, valid_score: 0.109800]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0740    recall@20: 0.1098    ndcg@10: 0.0398    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0735    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0491    
02 Aug 12:50    INFO ██ MGCN--Best validation results updated!!!
02 Aug 12:50    INFO epoch 47 training [time: 5.23s, train loss: 6.4618]
02 Aug 12:50    INFO epoch 47 evaluating [time: 2.24s, valid_score: 0.109200]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0744    recall@20: 0.1092    ndcg@10: 0.0401    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0735    recall@20: 0.1091    ndcg@10: 0.0400    ndcg@20: 0.0490    
02 Aug 12:50    INFO epoch 48 training [time: 5.22s, train loss: 6.4384]
02 Aug 12:50    INFO epoch 48 evaluating [time: 2.26s, valid_score: 0.109300]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0743    recall@20: 0.1093    ndcg@10: 0.0400    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0736    recall@20: 0.1089    ndcg@10: 0.0400    ndcg@20: 0.0490    
02 Aug 12:50    INFO epoch 49 training [time: 5.23s, train loss: 6.4050]
02 Aug 12:50    INFO epoch 49 evaluating [time: 2.26s, valid_score: 0.109100]
02 Aug 12:50    INFO valid result: 
recall@10: 0.0741    recall@20: 0.1091    ndcg@10: 0.0399    ndcg@20: 0.0488    
02 Aug 12:50    INFO test result: 
recall@10: 0.0734    recall@20: 0.1090    ndcg@10: 0.0399    ndcg@20: 0.0489    
02 Aug 12:50    INFO epoch 50 training [time: 5.21s, train loss: 6.3900]
02 Aug 12:51    INFO epoch 50 evaluating [time: 2.32s, valid_score: 0.109000]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0734    recall@20: 0.1090    ndcg@10: 0.0396    ndcg@20: 0.0486    
02 Aug 12:51    INFO test result: 
recall@10: 0.0732    recall@20: 0.1086    ndcg@10: 0.0398    ndcg@20: 0.0487    
02 Aug 12:51    INFO epoch 51 training [time: 5.21s, train loss: 6.3543]
02 Aug 12:51    INFO epoch 51 evaluating [time: 2.36s, valid_score: 0.108700]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0736    recall@20: 0.1087    ndcg@10: 0.0397    ndcg@20: 0.0486    
02 Aug 12:51    INFO test result: 
recall@10: 0.0732    recall@20: 0.1084    ndcg@10: 0.0397    ndcg@20: 0.0487    
02 Aug 12:51    INFO epoch 52 training [time: 5.21s, train loss: 6.3381]
02 Aug 12:51    INFO epoch 52 evaluating [time: 2.23s, valid_score: 0.108800]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0731    recall@20: 0.1088    ndcg@10: 0.0395    ndcg@20: 0.0485    
02 Aug 12:51    INFO test result: 
recall@10: 0.0733    recall@20: 0.1084    ndcg@10: 0.0398    ndcg@20: 0.0487    
02 Aug 12:51    INFO epoch 53 training [time: 5.21s, train loss: 6.3185]
02 Aug 12:51    INFO epoch 53 evaluating [time: 2.22s, valid_score: 0.108900]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0728    recall@20: 0.1089    ndcg@10: 0.0395    ndcg@20: 0.0486    
02 Aug 12:51    INFO test result: 
recall@10: 0.0728    recall@20: 0.1084    ndcg@10: 0.0396    ndcg@20: 0.0486    
02 Aug 12:51    INFO epoch 54 training [time: 5.20s, train loss: 6.3002]
02 Aug 12:51    INFO epoch 54 evaluating [time: 2.26s, valid_score: 0.108900]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0731    recall@20: 0.1089    ndcg@10: 0.0395    ndcg@20: 0.0485    
02 Aug 12:51    INFO test result: 
recall@10: 0.0727    recall@20: 0.1078    ndcg@10: 0.0395    ndcg@20: 0.0484    
02 Aug 12:51    INFO epoch 55 training [time: 5.21s, train loss: 6.2739]
02 Aug 12:51    INFO epoch 55 evaluating [time: 2.32s, valid_score: 0.108500]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0727    recall@20: 0.1085    ndcg@10: 0.0393    ndcg@20: 0.0484    
02 Aug 12:51    INFO test result: 
recall@10: 0.0724    recall@20: 0.1078    ndcg@10: 0.0393    ndcg@20: 0.0483    
02 Aug 12:51    INFO epoch 56 training [time: 5.22s, train loss: 6.2615]
02 Aug 12:51    INFO epoch 56 evaluating [time: 2.26s, valid_score: 0.108600]
02 Aug 12:51    INFO valid result: 
recall@10: 0.0724    recall@20: 0.1086    ndcg@10: 0.0391    ndcg@20: 0.0483    
02 Aug 12:51    INFO test result: 
recall@10: 0.0723    recall@20: 0.1072    ndcg@10: 0.0393    ndcg@20: 0.0481    
02 Aug 12:52    INFO epoch 57 training [time: 5.23s, train loss: 6.2428]
02 Aug 12:52    INFO epoch 57 evaluating [time: 2.25s, valid_score: 0.108500]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0722    recall@20: 0.1085    ndcg@10: 0.0390    ndcg@20: 0.0482    
02 Aug 12:52    INFO test result: 
recall@10: 0.0721    recall@20: 0.1069    ndcg@10: 0.0393    ndcg@20: 0.0482    
02 Aug 12:52    INFO epoch 58 training [time: 5.23s, train loss: 6.2224]
02 Aug 12:52    INFO epoch 58 evaluating [time: 2.24s, valid_score: 0.108200]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0724    recall@20: 0.1082    ndcg@10: 0.0390    ndcg@20: 0.0481    
02 Aug 12:52    INFO test result: 
recall@10: 0.0721    recall@20: 0.1065    ndcg@10: 0.0392    ndcg@20: 0.0479    
02 Aug 12:52    INFO epoch 59 training [time: 5.21s, train loss: 6.2071]
02 Aug 12:52    INFO epoch 59 evaluating [time: 2.37s, valid_score: 0.108000]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0725    recall@20: 0.1080    ndcg@10: 0.0390    ndcg@20: 0.0480    
02 Aug 12:52    INFO test result: 
recall@10: 0.0725    recall@20: 0.1065    ndcg@10: 0.0393    ndcg@20: 0.0479    
02 Aug 12:52    INFO epoch 60 training [time: 5.25s, train loss: 6.1825]
02 Aug 12:52    INFO epoch 60 evaluating [time: 2.23s, valid_score: 0.108100]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0724    recall@20: 0.1081    ndcg@10: 0.0389    ndcg@20: 0.0480    
02 Aug 12:52    INFO test result: 
recall@10: 0.0723    recall@20: 0.1070    ndcg@10: 0.0391    ndcg@20: 0.0479    
02 Aug 12:52    INFO epoch 61 training [time: 5.21s, train loss: 6.1664]
02 Aug 12:52    INFO epoch 61 evaluating [time: 2.24s, valid_score: 0.108100]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0718    recall@20: 0.1081    ndcg@10: 0.0387    ndcg@20: 0.0479    
02 Aug 12:52    INFO test result: 
recall@10: 0.0722    recall@20: 0.1071    ndcg@10: 0.0391    ndcg@20: 0.0479    
02 Aug 12:52    INFO epoch 62 training [time: 5.21s, train loss: 6.1609]
02 Aug 12:52    INFO epoch 62 evaluating [time: 2.26s, valid_score: 0.108100]
02 Aug 12:52    INFO valid result: 
recall@10: 0.0721    recall@20: 0.1081    ndcg@10: 0.0388    ndcg@20: 0.0479    
02 Aug 12:52    INFO test result: 
recall@10: 0.0722    recall@20: 0.1069    ndcg@10: 0.0390    ndcg@20: 0.0478    
02 Aug 12:53    INFO epoch 63 training [time: 5.21s, train loss: 6.1452]
02 Aug 12:53    INFO epoch 63 evaluating [time: 2.25s, valid_score: 0.108400]
02 Aug 12:53    INFO valid result: 
recall@10: 0.0717    recall@20: 0.1084    ndcg@10: 0.0388    ndcg@20: 0.0481    
02 Aug 12:53    INFO test result: 
recall@10: 0.0720    recall@20: 0.1068    ndcg@10: 0.0389    ndcg@20: 0.0477    
02 Aug 12:53    INFO epoch 64 training [time: 5.22s, train loss: 6.1287]
02 Aug 12:53    INFO epoch 64 evaluating [time: 2.34s, valid_score: 0.107700]
02 Aug 12:53    INFO valid result: 
recall@10: 0.0715    recall@20: 0.1077    ndcg@10: 0.0387    ndcg@20: 0.0479    
02 Aug 12:53    INFO test result: 
recall@10: 0.0724    recall@20: 0.1064    ndcg@10: 0.0391    ndcg@20: 0.0477    
02 Aug 12:53    INFO epoch 65 training [time: 5.22s, train loss: 6.1266]
02 Aug 12:53    INFO epoch 65 evaluating [time: 2.25s, valid_score: 0.107700]
02 Aug 12:53    INFO valid result: 
recall@10: 0.0716    recall@20: 0.1077    ndcg@10: 0.0387    ndcg@20: 0.0478    
02 Aug 12:53    INFO test result: 
recall@10: 0.0721    recall@20: 0.1064    ndcg@10: 0.0390    ndcg@20: 0.0477    
02 Aug 12:53    INFO epoch 66 training [time: 5.21s, train loss: 6.1062]
02 Aug 12:53    INFO epoch 66 evaluating [time: 2.25s, valid_score: 0.107700]
02 Aug 12:53    INFO valid result: 
recall@10: 0.0716    recall@20: 0.1077    ndcg@10: 0.0386    ndcg@20: 0.0477    
02 Aug 12:53    INFO test result: 
recall@10: 0.0724    recall@20: 0.1062    ndcg@10: 0.0389    ndcg@20: 0.0475    
02 Aug 12:53    INFO epoch 67 training [time: 5.21s, train loss: 6.0898]
02 Aug 12:53    INFO epoch 67 evaluating [time: 2.25s, valid_score: 0.108100]
02 Aug 12:53    INFO valid result: 
recall@10: 0.0718    recall@20: 0.1081    ndcg@10: 0.0387    ndcg@20: 0.0478    
02 Aug 12:53    INFO test result: 
recall@10: 0.0719    recall@20: 0.1060    ndcg@10: 0.0387    ndcg@20: 0.0474    
02 Aug 12:53    INFO +++++Finished training, best eval result in epoch 46
02 Aug 12:53    INFO best valid result: recall@10: 0.0740    recall@20: 0.1098    ndcg@10: 0.0398    ndcg@20: 0.0488    
02 Aug 12:53    INFO test result: recall@10: 0.0735    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0491    
02 Aug 12:53    INFO ████Current BEST████:
Parameters: ['seed', 'cl_loss']=(999, 0.01),
Valid: recall@10: 0.0740    recall@20: 0.1098    ndcg@10: 0.0398    ndcg@20: 0.0488    ,
Test: recall@10: 0.0735    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0491    



02 Aug 12:53    INFO Saved best model to ./saved_models/MGCN-clothing-20250802_125347.pth
02 Aug 12:53    INFO 
============All Over=====================
02 Aug 12:53    INFO Parameters: ['seed', 'cl_loss']=(999, 0.01),
 best valid: recall@10: 0.0740    recall@20: 0.1098    ndcg@10: 0.0398    ndcg@20: 0.0488    ,
 best test: recall@10: 0.0735    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0491    
02 Aug 12:53    INFO 

█████████████ BEST ████████████████
02 Aug 12:53    INFO 	Parameters: ['seed', 'cl_loss']=(999, 0.01),
Valid: recall@10: 0.0740    recall@20: 0.1098    ndcg@10: 0.0398    ndcg@20: 0.0488    ,
Test: recall@10: 0.0735    recall@20: 0.1090    ndcg@10: 0.0402    ndcg@20: 0.0491    


